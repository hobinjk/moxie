(()=>{var Fe=Object.create;var te=Object.defineProperty;var Le=Object.getOwnPropertyDescriptor;var Ce=Object.getOwnPropertyNames;var ke=Object.getPrototypeOf,ye=Object.prototype.hasOwnProperty;var Ne=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var Ie=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of Ce(t))!ye.call(e,s)&&s!==n&&te(e,s,{get:()=>t[s],enumerable:!(r=Le(t,s))||r.enumerable});return e};var ne=(e,t,n)=>(n=e!=null?Fe(ke(e)):{},Ie(t||!e||!e.__esModule?te(n,"default",{value:e,enumerable:!0}):n,e));var q=Ne((mt,oe)=>{async function He(e){let n=await(await fetch(`https://dps.report/getJson?permalink=${e}`)).json();if(n.hasOwnProperty("error")){alert(`failed to fetch that log, message from dps.report: "${n.error}"`);return}return ie(n,[])}function xe(e){return ie(e,[])}function ie(e,t){if(e.skillMap)for(let i in e.skillMap){let u=e.skillMap[i];u.id||(u.id=i.substr(1)),t.push(u)}if(e.buffMap)for(let i in e.buffMap){let u=e.buffMap[i];u.id||(u.id=i.substr(1)),t.push(u)}let n={},r={},s={},a=e.players.map((i,u)=>Object.assign({id:u},i)),o=!1;for(let i=0;i<e.players.length;i++){if(e.players[i].hasOwnProperty("details")){let{buffs:f,casts:S}=Ue(e.players[i].details);n[i]=f,r[i]=S}else{let{buffs:f,casts:S}=$e(e.players[i]);o=!0,n[i]=f,r[i]=S}let u=e.players[i].targetDamage1S;u&&u[0]&&(s[i]=u[0][0])}let d={};for(let i of t)d[i.id]=i.name;let c=o?1:1e3;return{boss:e.fightName,players:a,start:e.phases[0].start*c,end:e.phases[0].end*c,skills:d,casts:r,buffs:n,targetDamage1S:s}}function Ue(e){let t={};for(let r of e.boonGraph[0]){t[r.id]=[];let s=0;for(let a of r.states){let o=a[0]*1e3,d=a[1];for(let c=0;c<Math.abs(d-s);c++)d>s?t[r.id].push({Apply:o}):t[r.id].push({Remove:o});s=d}}let n=[];for(let r of e.rotation)if(!!r[0])for(let s of e.rotation[0]){let a=s[0]*1e3,o=s[1],d=s[2],c=s[3],i=s[4];n.push({id:o,start:a,end:a+d,fired:c!==2})}return{buffs:t,casts:n}}function $e(e){let t={},n=[];for(let r of e.buffUptimes){t[r.id]=[];let s=0;for(let a of r.states){let[o,d]=a;for(let c=0;c<Math.abs(d-s);c++)d>s?t[r.id].push({Apply:o}):t[r.id].push({Remove:o});s=d}}e.rotation||(e.rotation=[]);for(let r of e.rotation){let s=r.id;for(let a of r.skills){let o=a.castTime,d=o+a.duration,c=a.duration+a.timeGained>0;n.push({id:s,start:o,end:d,fired:c})}}return{buffs:t,casts:n}}oe.exports={parseJson:xe,getJson:He}});var J=class{constructor(){this.loadSkill=this.loadSkill.bind(this),this.data={}}load(t){return Promise.all(Object.keys(t).map(this.loadSkill))}async loadSkill(t){try{let r=await(await fetch(`api-cache/${t}.json`)).json();this.data[t]=r}catch{console.log("could not fetch",t),await this.loadSkillFromAPI(t)}}async loadSkillFromAPI(t){try{let r=await(await fetch(`https://api.guildwars2.com/v2/skills/${t}`)).json();this.data[t]=r}catch{console.log("really could not fetch",t)}}get(t){return this.data[t]}},N=new J;var l={GLYPH_OF_STORMS_FIRE:5736,GLYPH_OF_STORMS_AIR:5737,PRIMORDIAL_STANCE:42086,PRIMORDIAL_STANCE_EFFECT:40183,ATTUNEMENT_FIRE_FIRE:43470,ATTUNEMENT_AIR_AIR:42264,ATTUNEMENT_EARTH_EARTH:44857,ARCANE_BLAST:5539,FLAME_UPRISING:45313,QUANTUM_STRIKE:43803,FIRE_GRAB:5557,ELEMENTS_OF_RAGE:42416,CONJURE_FIERY_GREATSWORD:5516,FIERY_GREATSWORD_FIRESTORM:5531,FIERY_GREATSWORD_FIERY_RUSH:5517,FRESH_AIR:34241,ASSASSINS_SIGNET_ACTIVE:44597,BOUNDING_DODGER:33162,FIST_FLURRY:30868,THE_PRESTIGE:10285,MAGIC_BULLET:10229,CRY_OF_FRUSTRATION:10190,AXES_OF_SYMMETRY:43761,IMAGINARY_AXES:44321,SIGNET_OF_THE_ETHER:21750,PHANTASMAL_BERSERKER:10221,PHANTASMAL_SWORDSMAN:10174,PHANTASMAL_DISENCHANTER:10267,PHANTASMAL_WARDEN:10282,WELL_OF_CALAMITY:30525,WELL_OF_RECALL:29856,WELL_OF_ACTION:30814,SIGNET_OF_INSPIRATION:10236,GRAVITY_WELL:30359,DODGE:65001,WEAPON_SWAP:-2,WEAVE_SELF:43638,ATTUNEMENT_AIR_WATER:"-12",ATTUNEMENT_AIR_FIRE:"-11",ATTUNEMENT_WATER_FIRE:"-8",ATTUNEMENT_FIRE_AIR:"-6",ATTUNEMENT_EARTH_AIR:"-16",ATTUNEMENT_EARTH_FIRE:"-14",ATTUNEMENT_WATER_EARTH:"-10",ATTUNEMENT_FIRE_EARTH:"-7",ATTUNEMENT_FIRE_WATER:"-5",CONJURE_LIGHTNING_HAMMER:5624,SUNDERING_LEAP:29613,THROW_BOLAS:14354,SWORD_OF_JUSTICE:9168,SWORD_OF_JUSTICE_ETERNAL_ARMORY:44846,ORB_OF_WRATH:9098,ZEALOTS_FIRE:9089,RENEWED_FOCUS:9154,SPEAR_OF_JUSTICE:29632,JUSTICE:30232,SHIELD_OF_COURAGE:30029,MANTRA_OF_POTENCE:40915,SHARPENING_STONE:9963,ONE_WOLF_PACK:45717,FROST_TRAP:12492,SIC_EM:33902,TWICE_AS_VICIOUS:45600,SEARING_FISSURE:28357,LEGENDARY_ASSASSIN_STANCE:27890,BATTLE_SCARS:26646,FORERUNNER_OF_DEATH:62811,SHREDDER_GYRO:29921,SUPERCONDUCTING_SIGNET:63113,FLAME_BLAST:5931,WELL_OF_BOUNTY:63323,PURGING_FLAMES:9187,STONESTRIKE:62683,SHATTERING_ICE:62698,CRESCENT_WIND_BUFF:62707,SHOCK_BLAST:62716,DEPLOY_JADE_SPHERE:62723,ELEMENTAL_EMPOWERMENT:62733,WIND_SLAM:62747,FLAME_WHEEL:62758,ROCKY_LOOP_BUFF:62768,GROUND_POUND:62778,RELENTLESS_FIRE_BUFF:62805,TRIPLE_SEAR:62807,HURRICANE_OF_PAIN:62812,DEPLOY_JADE_SPHERE2:62813,ICY_COIL:62834,CLEANSING_TYPHOON:62843,STREAM_STRIKE:62865,GRAND_FINALE:62876,SURGING_FLAMES:62884,CRESCENT_WIND:62887,SHATTERING_ICE_EFFECT:62909,MOLTEN_END:62910,SINGEING_STRIKE:62925,FLAME_WHEEL_BUFF:62931,EMPOWERING_AURAS:62939,DEPLOY_JADE_SPHERE3:62940,CRASHING_FONT:62948,RELENTLESS_FIRE:62965,ROCKY_LOOP:62975,WHIRLING_STONES:62976,ICY_COIL_BUFF:62984,FACET_OF_LIGHT:27220,DEADLY_BLADES:63409,"Confusing Images":10168,"Chaos Storm":10169,"Mind Slash":10170,"Mind Gash":10171,"Mind Spike":10172,"Illusionary Leap":10173,"Phantasmal Swordsman":10174,"Phantasmal Duelist":10175,"Temporal Curtain":10186,Veil:10187,"Phantasmal Mage":10189,"Cry of Frustration":10190,"Mind Wrack":10191,Distortion:10192,"Mind Blast":10196,"Null Field":10203,"Mantra of Pain":10211,"Phantasmal Warlock":10216,"Mind Stab":10218,"Spatial Surge":10219,"Phantasmal Berserker":10221,"Magic Bullet":10229,"Signet of Midnight":10234,"Signet of Inspiration":10236,"Illusion of Life":10244,"Signet of Illusions":10247,"Phantasmal Disenchanter":10267,"Winds of Chaos":10273,"Illusionary Counter":10276,"Illusionary Riposte":10280,"Phantasmal Warden":10282,"The Prestige":10285,"Ether Bolt":10289,"Ether Blast":10290,"Ether Clone":10291,"Time Warp":10311,Counterspell:10314,"Mirror Blade":10333,"Blurred Frenzy":10334,"Well of Blood":10527,"Ghastly Claws":10528,"Grasping Dead":10532,"Blood Is Power":10544,"Well of Corruption":10545,"Well of Suffering":10546,Plaguelands:10549,"Putrid Curse":10552,"Spinal Shivers":10555,"Wail of Doom":10556,"Locust Swarm":10557,"Life Leech":10560,"Rending Claws":10561,"Necrotic Grasp":10596,Chillblains:10605,Epidemic:10606,"Well of Darkness":10607,"Spectral Ring":10608,"Well of Power":10609,Charge:45743,Fear:10660,"Blood Curse":10698,"Rending Curse":10699,"Unholy Feast":10701,"Deathly Swarm":10705,"Enfeebling Blood":10706,Bandage:1175,Ricochet:12466,"Poison Volley":12468,Barrage:12469,Crossfire:12470,Slash:12474,"Crippling Thrust":12472,"Precision Swipe":12473,"Hilt Bash":12475,"Crippling Talon":12477,"Stalker's Strike":12478,Splitblade:12480,Thunderclap:5728,"Throw Dirt":12486,Slice:12487,"Enduring Swing":12488,"Winter's Bite":12490,"Signet of the Wild":12491,"Frost Trap":12492,"Stone Spirit":12495,"Viper's Nest":12496,"Frost Spirit":12497,"Flame Trap":12499,"Muddy Terrain":12501,Bonfire:12504,"Crippling Shot":12507,"Concussion Shot":12508,"Rapid Fire":12509,"Long Range Shot":12510,"Point-Blank Shot":12511,Swoop:12521,Counterattack:12522,Maul:46629,"Sharpening Stone":12537,"Spirit of Nature":12569,"Hunter's Shot":12573,Entangle:12580,"Cold Snap":12593,"Call Lightning":45216,Quicksand:12595,"Nature's Renewal":12596,"Hunter's Call":12620,"Call of the Wild":12621,'"Sic \'Em!"':12633,"Throw Torch":12635,"Path of Scars":12638,"Whirling Defense":12639,"Trail of Knives":13003,"Double Strike":13004,"Death Blossom":13006,"Shadow Strike":13010,"Trick Shot":13022,"Choking Gas":13024,"Prepare Thousand Needles":13026,"Hide in Shadows":13027,Caltrops:13028,"Smoke Bomb":13033,"Shadow Shot":13040,"Assassin's Signet":13046,"Signet of Malice":13050,"Skale Venom":13055,"Thieves Guild":13082,"Vital Shot":13084,"Wild Strike":13087,Heartseeker:13097,"Lotus Strike":13108,Repeater:59526,"Basilisk Venom":13132,"Throw Bolas":14354,"Greatsword Swing":14356,"Hammer Swing":14358,"Staggering Blow":14359,"Shield Bash":14361,Hamstring:14363,"Sever Artery":14364,Gash:14365,"Savage Leap":14366,Chop:14369,"Double Chop":14370,"Triple Chop":14371,"Greatsword Slice":14373,"Brutal Strike":14374,"Mace Smash":63077,"Mace Bash":14377,Pulverize:14378,"Hammer Bash":14384,"Hammer Smash":14385,"Fierce Blow":14386,"Throw Rock":14390,"Call of Valor":14394,"Throw Axe":14398,"Whirling Axe":14399,'"To the Limit!"':14402,"Banner of Strength":14405,"Banner of Discipline":14407,"Banner of Tactics":14408,"Balanced Stance":14412,Tremor:14415,"Dual Strike":14418,"Battle Standard":14419,"Cyclone Axe":14421,Eviscerate:43566,"Dual Shot":14431,"Whirlwind Attack":14447,"Hammer Shock":14482,"Seismic Leap":14490,"Final Thrust":14497,"Pommel Bash":14503,"Pin Down":14504,"Smoldering Arrow":14505,Counterblow:14507,Bladetrail:14510,Backbreaker:14511,"Fan of Fire":14519,"Hundred Blades":14554,"Throw Boulder":14556,"Vapor Blade":15716,Impale:15717,"Dragon's Claw":15718,"Cloak and Dagger":16432,"Reaper's Mark":19115,"Putrid Mark":19116,"Mark of Blood":19117,"Static Shock":21661,"Litany of Wrath":21664,"Signet of the Ether":21750,"Water Spirit":21773,"Aqua Surge":21775,"Thousand Cuts":24755,"Glyph of Lesser Elementals":25486,"Vengeful Hammers":26557,"Facet of Strength":26644,"Manifest Toxin":26666,"Forced Engagement":26679,"Unrelenting Assault":26699,"Anguish Swipe":26730,"Release Hammers":26956,"Facet of Elements":27014,"Misery Swipe":27066,Deathstrike:28625,"Gaze of Darkness":27080,"Impossible Odds":27107,"Elemental Blast":27162,"Facet of Light":27220,"Soothing Stone":27372,"Banish Enchantment":27505,"Field of the Mists":27665,"Facet of Chaos":27760,"Echoing Eruption":27964,"Rite of the Great Dwarf":27975,"Phase Smash":27976,"Chaotic Release":28075,"Legendary Dragon Stance":28085,"Drop the Hammer":28110,"Burst of Strength":28113,"Legendary Assassin Stance":28134,"Essence Sap":31438,"Coalescence of Ruin":28253,"Embrace the Darkness":28287,"Searing Fissure":28357,"Facet of Darkness":28379,"Relinquish Power":28382,"Temporal Rift":28409,"Legendary Dwarf Stance":28419,"Shackling Wave":28472,"Legendary Demon Stance":28494,"Inspiring Reinforcement":28516,"Hammer Bolt":28549,"Rift Slash":28964,"Surge of the Mists":28978,"Rejuvenating Assault":29002,"Preparation Thrust":29057,"Mender's Rebuke":29145,"Project Tranquility":29148,"Rapid Swipe":29180,"Chilling Isolation":29233,"Brutal Blade":29256,"Renewing Wave":29321,"Forceful Bash":29331,"Facet of Nature":29371,"Overload Water":29415,"Life Rend":29442,"Life Slash":29458,Wildfire:29533,'"Wash the Pain Away!"':29535,"Bandage Blast":29547,"Glyph of the Tides":30448,Mimic:29578,"Sundering Leap":29613,"Overload Earth":29618,"Deflecting Shot":29630,"Deja Vu":29649,"Dusk Strike":29705,"Overload Fire":29706,Terrify:29709,"Overload Air":29719,"Grasping Darkness":29740,"Bandage Self":29772,"Negative Bash":29785,"Test of Faith":29786,"Symbol of Energy":29789,"Continuum Split":29830,"Blaze Breaker":29845,"Arc Divider":29852,Nightfall:29855,"Well of Recall":29856,"Chilling Scythe":29867,"Spear of Justice":29887,"Weakening Charge":29911,"Shredder Gyro":29921,"Scorched Earth":29923,"Flames of War":29940,"Wild Blow":29941,'"Flash-Freeze!"':29948,"Infusing Terror":29958,'"Feel My Wrath!"':29965,Cyclone:30008,"Shield of Courage":30029,"Shattering Blow":30074,"Electro-whirl":30088,"Staff Bash":30135,Gravedigger:30163,"Blood Reckoning":30189,"Hook Strike":30210,"True Shot":30229,"Dragon's Maw":30273,"Life Reap":30278,"Chemical Field":30279,"Well of Eternity":30305,"Dust Storm":30336,"Head Butt":30343,"Medic Gyro":30357,"Gravity Well":30359,"Procession of Blades":30364,"Mortar Shot":30371,"Channeled Vigor":30400,'"Aftershock!"':30432,"Punishing Strikes":30434,Berserk:30435,"Puncture Shot":30471,"Equalizing Blow":30489,"Positive Strike":30501,"Soul Spiral":30504,"Med Blaster":30521,"Well of Calamity":30525,"Executioner's Scythe":30557,Vault:30597,"Staff Strike":30614,"Hunter's Ward":30628,"Tides of Time":30643,"Rocket Charge":30665,"Flaming Flurry":30682,"Palm Strike":30693,"Continuum Shift":30747,"Echo of Memory":30769,"Wings of Resolve":30783,"Reaper's Shroud":30792,"Lightning Orb":30795,"Fading Twilight":30799,"Elite Mortar Kit":30800,"Well of Action":30814,"Death's Charge":30825,Decapitate:30851,"Death Spiral":30860,"Fist Flurry":30868,"Poison Gas Shell":30885,"Exit Reaper's Shroud":30961,"Spare Capacitor":31167,"Blast Gyro":31248,"Lunar Impact":31318,"Seed of Life":31406,"Sublime Conversion":31496,"Natural Convergence":31503,"Ancestral Grace":31535,"Lightning Assault":31639,"Vine Surge":31700,"Solar Beam":31710,"Cosmic Ray":31796,"Astral Wisp":31889,"Rejuvenating Tides":31894,'"We Heal As One!"':31914,"Hunter's Verdict":33134,"Glyph of Elemental Harmony":34743,"Unholy Burst":38767,"Steal Warmth":39960,"Fire Strike":39964,"Steal Resistance":40133,"Rust Frenzy":40139,"Natural Frenzy":40170,"Bloodbane Path":40175,"Primordial Stance":40183,"Chaos Vortex":40184,"False Oasis":40200,"Smoke Assault":40255,"Trail of Anguish":40274,"Keen Strike":40275,"Leading Swipe":40301,"Fire Swipe":40326,"Icerazor's Ire":40485,Shattershot:40497,"Vulture Stance":40498,"Focused Slash":40560,"Primal Cry":40588,Earthshaker:40601,"Symbol of Vengeance":40624,"Earthen Vortex":40709,"Deadly Aim":40710,"Worldly Impact":40729,"Steal Precision":40888,"Steal Health":40903,"Steal Strength":40904,"Mantra of Potence":40915,"Grinding Stones":40963,Seiche:41052,"Crystal Sands":41065,"Skull Crack":41110,"Deactivate Photon Forge":41123,"Plasma Blast":41125,"Mirror Strikes":41164,"Rain of Spikes":41206,"Darkrazor's Daring":41220,Kick:41524,"Flash Cutter\u2014Storm":41684,"Mantra of Solace":41714,"Tome of Resolve":41780,"Serpent Stab":41800,Scorchrazor:41820,Sevenshot:41829,"Legendary Renegade Stance":41858,"Prime Light Beam":42009,"Blade Burst":42163,"Tome of Courage":42371,"Twin Strike":42271,"Pile Driver":42321,"Steam Surge":42330,"Ghastly Breach":42355,"Ashen Blast":42379,"Bright Slash\u2014Storm":42475,Flurry:42494,"Precise Cut":42745,"Citadel Bombardment":42836,"Laser Disk":42842,"Steal Time":42863,"Brutal Charge":46432,"Engage Photon Forge":42938,Beastmode:42944,"Razorclaw's Rage":42949,"Fracturing Strike":42954,"Leave Beastmode":43014,"Pyro Vortex":43074,"Crystalline Strike":43080,"Break Enchantments":43123,"Sand Flare":43148,"Steal Durability":43373,"Prelude Lash":43375,"Deadeye's Mark":43390,"Sun Edge":43476,"Double Arc":43536,"Frenzied Attack":43548,"Plasma Beam":43576,"Crystal Slash":43616,"Head Toss":43636,"Weave Self":43638,"Searing Slash":43826,"Crippling Leap":43726,"Axes of Symmetry":43761,"Pyroclastic Blast":43762,"Steal Defenses":43768,"Quantum Strike":43803,Spiritcrush:43993,"Wastrel's Ruin":44004,"Death's Judgment":44087,"Refraction Cutter":44110,"Full Counter":44165,"Light Strike\u2014Storm":44260,"Deadly Delivery":44278,"Oppressive Collapse":44296,"Imaginary Axes":44321,"Tome of Justice":44364,"Cauterizing Strike":44451,"Steal Mobility":44526,"Corona Burst":44530,"Light Strike":44588,"Bleeding Edge":44602,"Plasma Burst":44652,"Mirage Mirror":44677,"Charged Strike":44681,"Three Round Burst":44695,"Lacerating Chop":44791,"Ethereal Chop":44840,"Sword of Justice":9168,"Lesser Fiery Eruption":44918,"Disrupting Stab":44937,"Manifest Sand Shade":44946,"Bear Stance":44948,"Polaric Leap":44998,"Core Cleave":45047,"Lingering Thoughts":45243,"Polaric Slash":45259,"Flame Uprising":45313,"Blazing Edge":45402,"Rain of Swords":45425,"Groundwork Gouge":45426,Jaunt:45449,"Shadow Meld":45508,"Sun Ripper":45581,"Breakrazor's Bastion":45686,"One Wolf Pack":45717,"Bright Slash":45756,"Soulcleave's Summit":45773,"Photon Blitz":45783,"Dolyak Stance":45789,"Harrowing Wave":45846,"Flash Cutter":45890,"Moa Stance":45970,"Gleam Saber":45979,Clapotis:45983,"Stone Tide":46014,"Mud Slide":46018,"Crystalline Sunder":46024,"Mantra of Flame":46148,"Aura Slicer":46233,"Gale Strike":46295,"Shadow Gust":46335,"Lava Skin":46447,"Cleansing Field":49045,"Vital Burst":49082,"Infusion Bomb":50444,"Malicious Sneak Attack":50466,"Malicious Backstab":50481,"Seeking Judgment":51645,"Devouring Darkness":51647,"Searing Light":51660,"Transmute Lightning":51662,"True Nature":51696,"Transmute Fire":51711,"Frozen Burst":5487,"Lightning Whip":5489,Comet:5490,Fireball:5491,"Fire Attunement":5492,"Water Attunement":5493,"Air Attunement":5494,"Earth Attunement":5495,"Drake's Breath":5496,Flamewall:5497,"Stone Shards":5500,"Meteor Shower":5501,"Signet of Restoration":5503,Swipe:55031,"Soul Grasp":55050,"Discharge Lightning":5504,"Grasping Earth":5505,"Ether Renewal":5507,Flamestrike:5508,"Conjure Fiery Greatsword":5516,"Fiery Rush":5517,"Chain Lightning":5518,Stoning:5519,"Ring of Earth":5525,"Arc Lightning":5526,Eruption:5528,"Ride the Lightning":5529,"Swirling Winds":5530,Firestorm:5736,"Flame Wave":5532,"Cone of Cold":5537,Shatterstone:5538,"Arcane Blast":5539,"Signet of Fire":5542,"Lava Font":5548,"Water Blast":5549,"Ice Spike":5550,"Lightning Surge":5552,"Magnetic Wave":5555,"Freezing Gust":5556,"Fire Grab":5557,"Earthen Rush":5559,"Lightning Strike":5561,Gale:5562,"Conjure Lightning Hammer":5624,"Burning Speed":5644,Convergence:5646,"Static Field":5671,Phoenix:5675,"Flame Burst":5679,Geyser:5681,"Windborne Speed":5682,"Shock Wave":5686,Updraft:5687,"Time Sink":56873,"Ring of Fire":5691,"Dragon's Tooth":5692,"Function Gyro":56920,"Split Second":56930,Rewinder:56928,"Ice Shards":5693,"Rock Barrier":5695,"Invoke Lightning":5725,"Lightning Swing":5726,"Static Swing":5727,"Lightning Storm":5737,Sandstorm:5738,Hurl:5780,"Med Kit":5802,"Poison Grenade":5806,"Shrapnel Grenade":5807,"Freeze Grenade":5809,"Grenade Barrage":5810,"Bomb Kit":5812,"Big Ol' Bomb":5813,"Concussion Bomb":5822,"Fire Bomb":5823,"Fragmentation Shot":5827,"Poison Dart Volley":5828,"Static Shot":5829,Blowtorch:5831,Bomb:5842,"Supply Crate":5868,Grenade:5882,Flamethrower:5927,"Flame Jet":5928,Napalm:5929,"Air Blast":5930,"Flame Blast":5931,"Elixir Gun":5933,"Tranquilizer Dart":5934,"Glob Shot":5935,"Acid Bomb":5936,"Super Elixir":5937,Fumigate:5965,"Rifle Burst":6003,"Net Shot":6004,"Jump Shot":6005,"Grenade Kit":6020,"Magnetic Shield":6053,Blunderbuss:6153,"Overcharged Shot":6154,"Throw Mine":6161,"Mine Field":6164,"Surprise Shot":6178,"Flying Cutter":62510,"Vile Blast":62511,"Weeping Shots":62513,"Vicious Shot":62517,"Willbender Flames":62618,"Elixir of Risk":62530,"Voracious Arc":62539,"Exit Harbinger Shroud":62540,Bladecall:62560,"Whirling Light":62565,"Harbinger Shroud":62567,"Bladesong Harmony":62617,"Bladeturn Requiem":62597,"Bladesong Dissonance":62602,"Unstable Bladestorm":62607,"Flash Combo":62608,"Tainted Bolts":62611,"Bladesong Sorrow":62616,"Dark Barrage":62621,"Elixir of Anguish":62662,"Elixir of Promise":62667,"Rushing Justice":62668,"Devouring Cut":62672,Stonestrike:62683,"Mist Slash":62688,"Mist Unleashed":62692,"Water Rush":62694,Gunstinger:62697,"Shattering Ice":62698,"Shock Blast":62716,"Deploy Jade Sphere":62940,"Elemental Celerity":62725,"Unsheathe Gunsaber":62745,"Wind Slam":62747,"Legendary Alliance":62749,"Arcing Mists":62752,"Flame Wheel":62758,"Ground Pound":62778,"Dragon's Roar":62800,"Dragon Trigger":62803,"Triple Sear":62807,"Hurricane of Pain":62812,"Nomad's Advance":62832,"Icy Coil":62834,"Cleansing Typhoon":62843,"Sheathe Gunsaber":62861,"Chilling Crack":62862,"Stream Strike":62865,"Grand Finale":62876,"Reaver's Rage":62878,"Surging Flames":62884,"Crescent Wind":62887,"Legendary Alliance Stance":62891,"Phantom's Onslaught":62895,"Tactical Reload":62901,"Molten End":62910,"Mist Swing":62913,"Singeing Strike":62925,"Eternity's Requiem":62929,"Spear of Archemorus":62942,"Crashing Font":62948,"Rain of Blows":62958,"Relentless Fire":62965,"Rocky Loop":62975,"Whirling Stones":62976,"Shadow Bolt":63066,Siphon:63067,"Overbearing Smash":63075,"Superconducting Signet":63113,"Hammer Strike":63118,"Sundering Volley":63129,"Unleashed Savage Shock Wave":63131,"Triple Bolt":63134,"Enter Shadow Shroud":63155,"Exploding Spores":63157,"Energizing Slam":63169,"Barrier Blast":63174,"Double Bolt":63182,"Mace Strike":63186,"Unleashed Thump":63208,"Hammer Slam":63222,"Rocket Fist Prototype":63234,"Exit Shadow Shroud":63251,"Twilight Combo":63254,"Well of Sorrow":63276,"Well of Gloom":63292,Shadowsquall:63314,"Well of Bounty":63323,Thump:63330,"Unleashed Wild Swing":63335,"Jade Buster Cannon":63374,"Relentless Whirl":63438,"Rifle Burst Grenade":68079,"Overcharged Cartridges":68085,"Leap of Faith":9080,"Whirling Wrath":9081,"Shield of Wrath":9082,"Protector's Strike":9086,"Shield of Judgment":9087,"Cleansing Flame":9088,"Zealot's Fire":9089,"Symbol of Punishment":9090,"Shield of Absorption":9091,"Symbol of Judgment":9095,"Wave of Light":9096,"Symbol of Blades":9097,"Orb of Wrath":9098,"Chains of Light":9099,Shelter:9102,"Zealot's Flame":9104,"Sword of Wrath":9105,"Sword Arc":9106,"Zealot's Defense":9107,"Faithful Strike":9108,"True Strike":9109,"Pure Strike":9110,"Symbol of Faith":9111,"Ray of Judgment":9112,"Bolt of Wrath":9122,Strike:9137,"Vengeful Strike":9138,"Wrathful Strike":9139,"Holy Strike":9140,"Symbol of Swiftness":9143,"Line of Warding":9144,"Symbol of Resolution":9146,"Binding Blade":9147,Wrath:9149,"Renewed Focus":9154,"Purging Flames":9187,Pull:9226,"Sword Wave":9227,"Bane Signet":9241,"Smite Condition":9245,"Hallowed Ground":9253,Empower:9265};var T=class{constructor(t,n,r){this.start=t,this.end=n,this.label=r}render(t){let n=document.createElement("li");n.classList.add("mishap");let r=document.createElement("a"),s=((this.start-t.start)/1e3).toFixed(2),a=((this.end-t.start)/1e3).toFixed(2);return r.dataset.start=this.start,r.dataset.end=this.end,r.innerHTML=`${s}s&mdash;${a}s`,r.href="#",r.classList.add("time-link"),n.appendChild(r),this.label&&n.appendChild(document.createTextNode(" "+this.label)),n}};var Be=document.querySelector(".report-card-items");function j(e,t,n){if(e.casts.length===0){console.warn("Log has no casts");return}switch(n.id){case"weaver_power_btth":case"weaver_power_fa_small":L(e),F(e),se(e),Me(e),V(e),C(e,l.ELEMENTS_OF_RAGE,100),ve(e,n),m(e,l.GLYPH_OF_STORMS_FIRE),m(e,l.GLYPH_OF_STORMS_AIR);break;case"weaver_power_btth_large":case"weaver_power_fa_large":L(e),F(e),se(e),V(e),C(e,l.ELEMENTS_OF_RAGE,100),m(e,l.GLYPH_OF_STORMS_AIR);break;case"catalyst_power":F(e),V(e),H(e,l.STONESTRIKE,54/93.5),C(e,l.CRESCENT_WIND_BUFF,89.2),C(e,l.FLAME_WHEEL_BUFF,98.6),C(e,l.ICY_COIL_BUFF,75.6),C(e,l.ROCKY_LOOP_BUFF,60.5),C(e,l.RELENTLESS_FIRE_BUFF,51.3),m(e,l.SHATTERING_ICE),m(e,l.GLYPH_OF_STORMS_AIR);break;case"daredevil_power":L(e,!0),F(e),C(e,l.ASSASSINS_SIGNET_ACTIVE,30),C(e,l.BOUNDING_DODGER,65),m(e,l.FIST_FLURRY);break;case"mirage":L(e),F(e),H(e,l.IMAGINARY_AXES,42/144),H(e,l.AXES_OF_SYMMETRY,16/144),ae(e,[{dur:11600,label:"A/P"},{dur:11600,label:"A/T"}],l["Phantasmal Duelist"],!0),m(e,l.THE_PRESTIGE),m(e,l.MAGIC_BULLET),m(e,l.CRY_OF_FRUSTRATION);let r={resets:new Set([l.SIGNET_OF_THE_ETHER])};m(e,l.SIGNET_OF_THE_ETHER),m(e,l["Phantasmal Duelist"],r),m(e,l["Phantasmal Mage"],r);break;case"chrono_power_gs":{L(e),F(e);let s={resets:new Set([l.SIGNET_OF_THE_ETHER])},a=Object.assign({leniency:2},s);m(e,l.SIGNET_OF_THE_ETHER),m(e,l.PHANTASMAL_BERSERKER,a),m(e,l.PHANTASMAL_SWORDSMAN,s),m(e,l.PHANTASMAL_DISENCHANTER,s),m(e,l.WELL_OF_CALAMITY);break}case"chrono_power_focus":{L(e),F(e);let s={resets:new Set([l.SIGNET_OF_THE_ETHER])},a=Object.assign({leniency:2},s);m(e,l.SIGNET_OF_THE_ETHER),m(e,l.PHANTASMAL_SWORDSMAN,s),m(e,l.PHANTASMAL_DISENCHANTER,s),m(e,l.PHANTASMAL_WARDEN,a);break}case"chrono_power_boon":{L(e),F(e);let s={resets:new Set([l.SIGNET_OF_THE_ETHER])},a=Object.assign({leniency:2},s);m(e,l.SIGNET_OF_THE_ETHER),m(e,l.PHANTASMAL_SWORDSMAN,a),m(e,l.SIGNET_OF_INSPIRATION),m(e,l.WELL_OF_ACTION),m(e,l.WELL_OF_RECALL);break}case"chrono_condi_boon":{L(e),F(e),m(e,l.SIGNET_OF_INSPIRATION),m(e,l.WELL_OF_ACTION),m(e,l.WELL_OF_RECALL);break}case"virtuoso_gs":{L(e),F(e);let s={resets:new Set([l.SIGNET_OF_THE_ETHER])};m(e,l.SIGNET_OF_THE_ETHER),B(e,l.PHANTASMAL_BERSERKER,3),B(e,l.PHANTASMAL_SWORDSMAN,2),C(e,l.DEADLY_BLADES,75),m(e,l.PHANTASMAL_DISENCHANTER,s),m(e,l["Rain of Swords"]),m(e,l["Bladesong Harmony"]),B(e,l["Unstable Bladestorm"],2),B(e,l.Bladecall,3),B(e,l["Mind Stab"],2),B(e,l["Mirror Blade"],3),ae(e,[{dur:13300,label:"GS"},{dur:12100,label:"D/S"}],l.PHANTASMAL_BERSERKER);break}case"virtuoso_focus":{L(e),F(e);let s={resets:new Set([l.SIGNET_OF_THE_ETHER])},a=Object.assign({leniency:3},s);m(e,l.SIGNET_OF_THE_ETHER),m(e,l.PHANTASMAL_WARDEN,a),m(e,l.PHANTASMAL_SWORDSMAN,s),m(e,l.PHANTASMAL_DISENCHANTER,s),B(e,l["Unstable Bladestorm"],2),B(e,l.Bladecall,4),C(e,l.DEADLY_BLADES,69),m(e,l["Rain of Swords"]),m(e,l["Bladesong Harmony"]);break}case"virtuoso_condi":{L(e),F(e);let s={resets:new Set([l.SIGNET_OF_THE_ETHER])},a={resets:new Set([l["Signet of Illusions"]])};m(e,l.SIGNET_OF_THE_ETHER),m(e,l.PHANTASMAL_WARDEN,s),m(e,l.PHANTASMAL_SWORDSMAN,s),m(e,l["Signet of Illusions"]),m(e,l["Bladesong Harmony"],a),m(e,l["Bladesong Sorrow"],a),H(e,l.Bladecall,23/105),H(e,l["Unstable Bladestorm"],11/105),C(e,l.DEADLY_BLADES,95);break}case"virtuoso_condi_chaos":{L(e),F(e),m(e,l["Bladesong Harmony"]),m(e,l["Bladesong Sorrow"]),m(e,l["Rain of Swords"]),m(e,l.Bladecall),m(e,l["Unstable Bladestorm"]),C(e,l.DEADLY_BLADES,95);break}case"firebrand_condi":case"firebrand_condi_quick":{L(e),F(e),Ge(e,l.SWORD_OF_JUSTICE_ETERNAL_ARMORY,16e3/1.25,4),De(e,l.ORB_OF_WRATH,6),Oe(e,l.ZEALOTS_FIRE,2,5e3);break}case"soulbeast_power_moa_gs":case"soulbeast_power_moa_lb":{L(e),F(e),m(e,l.ONE_WOLF_PACK),m(e,l.FROST_TRAP),C(e,l.SIC_EM,45),C(e,l.TWICE_AS_VICIOUS,97);break}case"renegade_kalla":case"renegade_deva_kalla":case"renegade_shiro":{L(e),F(e),Pe(e,l.SEARING_FISSURE,600),re(e);break}case"mechanist_condi_signets":{F(e),m(e,l["Shrapnel Grenade"],{leniency:3}),m(e,l.Blowtorch),m(e,l["Superconducting Signet"]),m(e,l["Poison Grenade"]);break}case"vindicator_power_gs":{L(e),F(e),C(e,l.FORERUNNER_OF_DEATH,100),m(e,l["Mist Unleashed"],{leniency:5}),m(e,l["Phantom's Onslaught"],{leniency:3}),m(e,l["Eternity's Requiem"]),H(e,l["Death Drop"],17/109);break}default:console.warn("Nothing cool to do for",n.id),L(e),F(e),re(e);break}}function b(e,t,n,r){let s=document.createElement("li");s.classList.add("report-card-item");let a=document.createElement("span");a.classList.add("grade","grade-"+t.toLowerCase()),a.textContent=t;let o=document.createElement("span");o.classList.add("explanation"),o.textContent=n;let d=document.createElement("div");d.classList.add("report-card-item-expander"),d.textContent="Show Mishaps",d.addEventListener("click",function(){s.classList.contains("open")?(d.textContent="Show Mishaps",s.classList.remove("open"),s.parentNode.classList.remove("single")):(d.textContent="Hide Mishaps",s.classList.add("open"),s.parentNode.classList.add("single"))}),s.appendChild(a),s.appendChild(document.createTextNode(" ")),s.appendChild(o),s.appendChild(d);let c=document.createElement("ul");c.classList.add("mishap-list");for(let i of r)c.appendChild(i.render(e));s.appendChild(c),Be.appendChild(s),console.log("additional data",r)}function L(e,t){let n=[];for(let c of e.casts){if(!c.fired)continue;let i=N.get(c.id);if(i&&i.slot){if(i.slot!=="Weapon_1")continue;if(!i.prev_chain&&i.next_chain&&n.push([c]),i.prev_chain){if(!n[n.length-1]){console.warn("Phantom chain!",c);continue}n[n.length-1].push(c)}}}let r={chains:[],total:0},s={chains:[],total:0};for(let c of n)c.length!==3&&(console.log("bad chain of length",c.length),c.length>3&&console.log("wait what",c),c.length===1?(r.total+=c[c.length-1].end-c[0].start,r.chains.push(c)):c.length===2&&(s.total+=c[c.length-1].end-c[0].start,s.chains.push(c)));console.log("wastedOne",r),console.log("wastedTwo",s);let a=e.casts[e.casts.length-1].end-e.casts[0].start;if(console.log("eliminating one",1-(a-r.total)/a),console.log("eliminating two",1-(a-s.total)/a),t){let c="";r.chains.length===0?c="S":r.chains.length<3?c="A":r.chains.length<7?c="B":r.chains.length<15?c="C":c="D";let i="attack";r.chains.length!==1&&(i+="s");let u=`Let ${r.chains.length} single auto ${i} happen`;b(e,c,u,r.chains.map(f=>new T(f[0].start,f[f.length-1].end)))}let o="";s.chains.length===0?o="S":s.chains.length<2?o="A":s.chains.length<5?o="B":o="C";let d=`Missed ${s.chains.length} auto chain finisher`;s.chains.length!==1&&(d+="s"),b(e,o,d,s.chains.map(c=>new T(c[0].start,c[c.length-1].end)))}function F(e){let t=0,n=[],r=0,s=[],a=-1;for(let f of e.casts)if(f.end!==f.start){if(a>0){let S=f.start-a;S<0?console.log("WHAT",f):(t+=S,S>30&&n.push(new T(a,f.start,e.skills[f.id]||"Unknown skill")))}f.fired||(r+=f.end-f.start,f.end-f.start>30&&s.push(new T(f.start,f.end,e.skills[f.id]||"Unknown skill"))),a=f.end}console.log("deadspace",t),console.log("cancels",r);let o=a-e.casts[0].start;console.log("out of",o),console.log("kills your deeps by",1-(o-t-r)/o);let d=`Did nothing for ${(t/1e3).toFixed(2)} seconds`,c="C";t<500?c="S":t<1e3?c="A":t<2e3&&(c="B"),b(e,c,d,n);let i=`Canceled skills for ${(r/1e3).toFixed(2)} seconds`,u="C";r<500?u="S":r<1e3?u="A":r<2e3&&(u="B"),b(e,u,i,s)}function se(e){let t=e.buffs[l.PRIMORDIAL_STANCE],n=e.buffs[l.ATTUNEMENT_FIRE_FIRE];if(!t){t=[];let i=1e3,u=5*i,f=e.start-u-i;for(let S of e.casts){if(S.id!==l.PRIMORDIAL_STANCE_EFFECT)continue;let _=S.start-i;_-f<u||(f>e.start&&t.push({Remove:Math.min(f+u,_-1)}),f=_,t.push({Apply:_}))}f>e.start&&t.push({Remove:Math.min(f+u,e.end)})}let r=0,s=-1,a=[],o=0;for(let i of t){if(i.Apply){s<0&&(s=i.Apply);continue}if(i.Remove&&s<0)continue;let u=i.Remove,f=0,S=u-s,_=-1;for(let g=r;g<n.length;g++){let p=n[g];if(p.Apply){_<0&&(_=p.Apply,r=g);continue}if(p.Remove&&_<0)continue;let w=p.Remove;if(w>s&&_<u&&(f+=Math.min(w,u)-Math.max(s,_)),w<u&&_>s){f+=S;break}if(_=-1,w>u)break}let E=f/S;o+=1,E<.8&&a.push({coverage:E,mishap:new T(s,u,`${Math.floor(E*100)}%`)}),s=-1}console.log(a);let d=`Misaligned ${a.length}/${o} Primordial Stance`;a.length!==1&&(d+="s");let c="D";a.length<1?c="S":a.length<2?c="A":a.length<4?c="B":a.length<6&&(c="C"),b(e,c,d,a.map(i=>i.mishap))}function Me(e){let n=e.start+16e3,r=3,s=0,a=[],o=!1;for(let c of e.casts)if(c.id===l.ARCANE_BLAST){o=!0;let i=-1;for(;c.start>n&&n>=0;)r<3?r+=1:(s+=1,i=Math.min(i,n)),n+=16e3;i>0&&a.push(new T(i,c.start)),r-=1,n<0&&(n=c.start+16e3)}if(n<e.end&&(s+=Math.floor((e.end-n)/16e3),a.push(new T(n,e.end))),!o)return;let d="D";if(s<1?d="S":s<2?d="A":s<4?d="B":s<6&&(d="C"),n>=0){let i=`Lost ${s} ${s===1?"charge":"charges"} of Arcane Blast`;b(e,d,i,a)}else b(e,"S","Missing Arcane Blast casts",[])}function V(e){if(!e.buffs.hasOwnProperty(l.ATTUNEMENT_FIRE_FIRE))return;let t={[l.FLAME_UPRISING]:!0,[l.QUANTUM_STRIKE]:!0,[l.GLYPH_OF_STORMS_FIRE]:!0,[l.FIRE_GRAB]:!0},n=[],r=e.buffs[l.ATTUNEMENT_FIRE_FIRE].filter(i=>i.hasOwnProperty("Remove")).values(),s=e.buffs[l.ATTUNEMENT_AIR_AIR].filter(i=>i.hasOwnProperty("Remove")).values(),a=r.next(),o=r.next();for(let i of e.casts){for(;a.value&&a.value.Remove<i.start;)a=r.next();for(;o.value&&o.value.Remove<i.start;)o=s.next();a.value&&a.value.Remove<i.end&&(console.log("ff transition",i,e.skills[i.id]),t[i.id]||n.push(new T(i.start,i.end,e.skills[i.id]))),o.value&&o.value.Remove<i.end&&(console.log("aa transition",i,e.skills[i.id]),t[i.id]||n.push(new T(i.start,i.end,e.skills[i.id])))}let d="D";n.length<1?d="S":n.length<3?d="A":n.length<6?d="B":n.length<14&&(d="C");let c=`Switched attunements during ${n.length} unsafe skill`;n.length!==1&&(c+="s"),b(e,d,c,n)}function C(e,t,n){let r=e.buffs[t],s=0,a=-1,o=-1,d=[];for(let E of r)E.Apply&&a<0&&(o>0&&(E.Apply-o>30&&d.push(new T(o,E.Apply)),s+=E.Apply-o),a=E.Apply),E.Remove&&(o=E.Remove,a=-1);let c=(s/1e3).toFixed(2),i=100-Math.floor(100*s/(e.end-e.start)),u=e.skills[t],f=`Had ${i}% uptime on ${u} (dropped for ${c}s, target ${n}%)`,S="D",_=(n-i)/n;_<.02?S="S":_<.05?S="A":_<.1?S="B":_<.25&&(S="C"),b(e,S,f,d)}function Y(e){let t=-1,n=-1,r=-1,s=-1,a=!0;for(let o of e)if(a)o.id===l.CONJURE_FIERY_GREATSWORD&&(t=o.start),o.id===l.FIERY_GREATSWORD_FIRESTORM&&(n=o.end,a=!1);else if(s<0)o.id===l.FIERY_GREATSWORD_FIERY_RUSH&&(console.log("secondStart",o.start),r=o.start),o.id===l.FIERY_GREATSWORD_FIRESTORM&&(s=o.end);else break;return{firstStart:t,firstEnd:n,secondStart:r,secondEnd:s}}function ve(e,t){let{firstStart:n,firstEnd:r,secondStart:s,secondEnd:a}=Y(t.casts),{firstStart:o,firstEnd:d,secondStart:c,secondEnd:i}=Y(e.casts);if(console.log(Y(t.casts),Y(e.casts)),o<0){b(e,"D","Didn't use FGS at all",[]);return}if(c<0){b(e,"D","Didn't pick up second FGS",[]);return}let u=d-o,f=i-c,S=r-n,_=a-s,E=o-e.start-n+(u-S)+(c-e.start-s)+(f-_);console.log("fgs diff",E,o,d,c,i);let g="D";E<500?g="S":E<1e3?g="A":E<2e3?g="B":E<4e3&&(g="C");function p(R){return`${Math.round(R/10)*10/1e3}s`}console.log("wait what",s);let w=[new T(o,d,`First FGS (bench is ${p(n)}-${p(r)})`),new T(c,i,`Second FGS (bench is ${p(s)}-${p(a)})`)];b(e,g,`Goofed around with FGS for ${(E/1e3).toFixed(2)} seconds`,w)}function m(e,t,n={}){let r=N.get(t);if(!r){console.warn("Missing skill data",t);return}let s,a=0;for(let g of r.facts)g.type==="Recharge"&&(s=g.value*1e3/1.25),g.text==="Count Recharge"&&(a=g.duration*1e3/1.25);if(!s){console.warn("Missing skill recharge",t,r);return}s=Math.max(a,s);let o=e.start+s,d=0,c=[],i=n.resets;for(let g of e.casts)if(i&&i.has(g.id)&&(o=g.end),g.id===t){if(g.start>o){let p=g.start-o;p>200&&c.push(new T(o,g.start)),d+=p}o=g.end+s}let u=Math.floor(d/s),f="D",S=n.leniency||0;u-=S,u<1?f="S":u<2?f="A":u<4?f="B":u<6&&(f="C"),u+=S;let E=`Lost ${u} ${u===1?"cast":"casts"} of ${r.name}`;b(e,f,E,c)}function B(e,t,n){let r=N.get(t);if(!r){console.warn("Missing skill data",t);return}let s=!0,a=!1,o=0,d=0,c=[];for(let E of e.casts)E.id===l.WEAPON_SWAP&&(s=!1,a&&(a=!1,c.push({start:d,end:E.end,castsInWeapon:o})),d=E.start),!s&&E.id===t&&(a||(a=!0,o=0),o+=1);let i="D",u=0,f=[];for(let E of c){if(E.castsInWeapon===n){u+=1;continue}f.push(new T(E.start,E.end,`Cast ${E.castsInWeapon}/${n} times`))}c.length-u===0?i="S":c.length-u<2?i="A":c.length-u<4?i="B":c.length-u<6&&(i="C");let S=c.length===1?"time":"times",_=`Cast ${r.name} ${n} per swap ${u}/${c.length} ${S}`;b(e,i,_,f)}function H(e,t,n){let r=N.get(t);if(!r){console.warn("Missing skill data",t);return}let s=0;for(let i of e.casts)i.id===t&&(s+=1);let a="D",o=Math.floor(n*(e.end-e.start)/1e3);o-s<1?a="S":o-s<2?a="A":o-s<4?a="B":o-s<6&&(a="C");let d=s===1?"time":"times",c=`Cast ${r.name} ${s}/${o} ${d}`;b(e,a,c,[])}function re(e){b(e,"S","Missing build-specific advice",[])}function De(e,t,n){let r=N.get(t);if(!r){console.warn("Missing skill data",t);return}let s=[];for(let i of e.casts)!i.fired||i.id===t&&s.push(new T(i.start,i.end));let a="D",o=s.length;o-=n,o<1?a="S":o<2?a="A":o<4?a="B":o<6&&(a="C"),o+=n;let d=o===1?"time":"times",c=`Cast bad skill ${r.name} ${o} ${d}`;b(e,a,c,s)}function Oe(e,t,n,r){let s=N.get(t);if(!s){console.warn("Missing skill data",t);return}let a=[],o=[],d=0;for(let S of e.casts)if(!!S.fired){if(S.id!==t){if(o.length===0)continue;S.start-o[0].end>r&&(o=[]);continue}o.push(S),o.length>n&&(a.push(new T(S.start,S.end)),d+=S.end-S.start)}let c="D",i=a.length;i<1?c="S":i<2?c="A":i<4?c="B":i<6&&(c="C");let u=i===1?"time":"times",f=`Spammed ${s.name} too much ${i} ${u} (lost ${(d/1e3).toFixed(2)}s)`;b(e,c,f,a)}function Ge(e,t,n,r){let s=N.get(t);if(!s){console.warn("Missing skill data",t);return}let a=r,o=e.start+n,d=0,c=[],i=!1;for(let f of e.casts)if(f.id===t){i=!0;let S=-1;for(;f.start>o&&o>=0;)a<r?a+=1:(d+=1,S=Math.min(S,o)),o+=n;S>0&&c.push(new T(S,f.start)),a-=1,o<0&&(o=f.start+n)}if(o<e.end&&(d+=Math.floor((e.end-o)/n),c.push(new T(o,e.end))),!i)return;let u="D";if(d<1?u="S":d<2?u="A":d<4?u="B":d<6&&(u="C"),o>=0){let S=`Lost ${d} ${d===1?"charge":"charges"} of ${s.name}`;b(e,u,S,c)}}function Pe(e,t,n){let r=N.get(t);if(!r){console.warn("Missing skill data",t);return}let s=[],a=[];for(let i of e.casts)if(i.id===t&&(a.push(i.end-i.start),i.end-i.start>n)){let u=(i.end-i.start-n)/1e3;s.push(new T(i.start+n,i.end,`Over by ${u.toFixed(2)}s`))}console.log("cast times",a);let o=0;for(let i of a)o+=i-n;let d="D";o<200?d="S":o<500?d="A":o<1e3?d="B":o<2e3&&(d="C");let c=`Left ${(o/1e3).toFixed(2)}s worth of ${r.name} uncancelled`;b(e,d,c,s)}function ae(e,t,n,r){let s=0,a=!1,o=0,d=[];for(let p of e.casts)if(p.id===n&&(a=!0),p.id===l.WEAPON_SWAP){if(a){let w=t[s];d.push({start:o,end:p.end,target:w}),s=(s+1)%t.length}o=p.end}let c="F",i=0,u=[],f=0,S=0;for(let p of d){let w=p.end-p.start;if(p.target.dur>w){i+=1;continue}let R=w-p.target.dur;f+=R,S=Math.max(S,R),u.push(new T(p.start,p.end,`Spent ${R} ms too long in ${p.target.label}`))}r&&(f-=S),f<50?c="S":f<200?c="A":f<800?c="B":f<2e3?c="C":f<5e3&&(c="D");let _=d.length===1?"swap":"swaps",E="";r&&(E=`, ignored ${S} ms`);let g=`Swapped late by ${f} ms (${i}/${d.length} ${_}${E})`;b(e,c,g,u)}var We={Tempest:!0,Weaver:!0,Catalyst:!0,Chronomancer:!0,Mirage:!0,Virtuoso:!0,Reaper:!0,Scourge:!0,Harbinger:!0,Scrapper:!0,Holosmith:!0,Mechanist:!0,Soulbeast:!0,Untamed:!0,Daredevil:!0,Deadeye:!0,Specter:!0,Guardian:!0,Dragonhunter:!0,Firebrand:!0,Willbender:!0,Herald:!0,Renegade:!0,Vindicator:!0,Berserker:!0,Spellbreaker:!0,Bladesworn:!0},U=class{constructor(t){this.boss=t.boss||"Unknown",console.log(t.players),this.players=t.players.filter(n=>We[n.profession]),this.onSelect=this.onSelect.bind(this),this.elt=null,this.playerSelect=null,this.listener=null}render(){this.elt=document.createElement("div"),this.elt.classList.add("target-select");let t=document.createElement("div");t.classList.add("target-select-boss-label"),t.textContent=this.boss,this.elt.appendChild(t),this.playerSelect=document.createElement("select"),this.playerSelect.classList.add("target-select-player-select");for(let r of this.players){let s=document.createElement("option");s.textContent=r.name,s.value=r.name,this.playerSelect.appendChild(s)}this.elt.appendChild(this.playerSelect);let n=document.createElement("input");n.classList.add("target-select-submit"),n.type="button",n.value="Analyze",n.addEventListener("click",this.onSelect),this.elt.appendChild(n),document.querySelector(".target-select-container").appendChild(this.elt)}remove(){this.elt.parentNode.classList.add("hidden"),this.elt.parentNode.removeChild(this.elt),this.playerSelect=null,this.elt=null}onSelect(){let t=null;for(let n of this.players)this.playerSelect.value===n.name&&(t=n);this.remove(),this.listener(t),this.listener=null}};var Q=ne(q());var ue=ne(q());async function h(e,t){let n=`./benchmarks/${e}.json`,s=await(await fetch(n)).json(),a=ue.default.parseJson(s);return a.casts=a.casts[0],a.buffs=a.buffs[0],a.targetDamage1S=a.targetDamage1S[0],a.id=e,t||(a.name=e.replace(/_/g," ")),a}function y(e,t){for(let n of e.casts)if(n.id===t)return!0;return!1}function le(e,t){if(e.buffMap){for(let n in e.buffMap)if(e.buffMap[n].name===t)return!0}if(e.skills){for(let n in e.skills)if(e.skills[n]===t)return!0}return!1}var ce=1187;function de(e,t){for(let n of e.buffUptimes)if(n.id===t){for(let r of n.buffData)for(let s in r.generated)if(r.generated[s]>0)return!0}return!1}function fe(e,t){let n=t.profession;if(n==="Tempest")return t.weapons.includes("Dagger")?e.skills.hasOwnProperty(l.GLYPH_OF_STORMS_FIRE)?h("tempest_condi_gos"):h("tempest_condi_ele"):h("tempest_power");if(n==="Weaver"){let r=e.skills.hasOwnProperty(l.WEAVE_SELF),s=e.buffs.hasOwnProperty(l.FRESH_AIR);if(r){if(s)return e.skills.hasOwnProperty(l.GLYPH_OF_STORMS_FIRE)?h("weaver_hybrid_fa"):h("weaver_hybrid_fa_elementals");if(t.weapons.includes("Sword"))return h("weaver_condi_sword");if(t.weapons.includes("Scepter"))return h("weaver_condi_scepter");if(t.weapons.includes("Dagger"))return h("weaver_condi_dagger")}else return t.weapons.includes("Staff")?h(r?"weaver_condi_staff":"weaver_power_staff"):y(e,l.CONJURE_LIGHTNING_HAMMER)?h(s?"weaver_power_fa_large":"weaver_power_btth_large"):h(s?"weaver_power_fa_small":"weaver_power_btth")}if(n==="Catalyst")return h("catalyst_power");if(n==="Chronomancer")return t.weapons.includes("Shield")?t.weapons.includes("Scepter")?h("chrono_condi_boon"):h("chrono_power_boon"):t.weapons.includes("Greatsword")?y(e,l.GRAVITY_WELL)?h("chrono_power_gs"):de(t,ce)?h("chrono_power_quick_gs"):h("chrono_power_gs"):t.weapons.includes("Scepter")?h("chrono_condi"):y(e,l.GRAVITY_WELL)?h("chrono_power_focus"):de(t,ce)?h("chrono_power_quick_focus"):t.weapons.includes("Pistol")?h("chrono_power_pistol"):h("chrono_power_focus");if(n==="Mirage")return t.weapons.includes("Staff")?t.weapons.includes("Axe")?h("mirage_staxe"):h("mirage_staff"):h("mirage");if(n==="Virtuoso")return t.weapons.includes("Greatsword")?h("virtuoso_gs"):y(e,l.PHANTASMAL_DISENCHANTER)?h("virtuoso_focus"):y(e,l.PHANTASMAL_WARDEN)?h("virtuoso_condi"):h("virtuoso_condi_chaos");if(n==="Reaper")return t.weapons.includes("Scepter")?h("reaper_condi"):h("reaper");if(n==="Scourge")return h("scourge");if(n==="Harbinger")return h("harbinger_condi");if(n==="Holosmith")return t.weapons.includes("Sword")?h("holo_power_sword"):t.weapons.includes("Rifle")?h("holo_power_rifle"):h("holo_condi");if(n==="Scrapper")return y(e,l.SHREDDER_GYRO)?h("scrapper_quick"):h("scrapper");if(n==="Mechanist")return y(e,l.SUPERCONDUCTING_SIGNET)?h("mechanist_condi_signets"):t.weapons.includes("Mace")?h("mechanist_power_alac"):y(e,l.FLAME_BLAST)?h("mechanist_condi_alac"):h("mechanist_condi");if(n==="Soulbeast")return t.weapons.includes("Shortbow")?h("soulbeast_condi_sb"):t.weapons.includes("Torch")?t.weapons[1]==="Axe"||t.weapons[3]==="Axe"?h("soulbeast_hybrid"):h("soulbeast_condi"):t.weapons.includes("Greatsword")?h("soulbeast_power_moa_gs"):h("soulbeast_power_moa_lb");if(n==="Untamed")return t.weapons.includes("Hammer")?h("untamed_power"):h("untamed_condi");if(n==="Daredevil")return t.weapons.includes("Staff")?h("daredevil_power"):h("daredevil_condi");if(n==="Deadeye"){if(t.weapons.includes("Rifle"))return h("deadeye_rifle");if(t.weapons.includes("Pistol"))return h("deadeye_condi")}if(n==="Specter")return y(e,l.WELL_OF_BOUNTY)?h("specter_condi_alac"):h("specter_condi");if(n==="Dragonhunter")return t.weapons.includes("Sword")?y(e,l.SHIELD_OF_COURAGE)?h("dragonhunter_sword_virtues"):h("dragonhunter_sword"):t.weapons.includes("Longbow")?h("dragonhunter_longbow"):h("dragonhunter_scepter");if(n==="Guardian")return h("guardian");if(n==="Firebrand")return y(e,l.RENEWED_FOCUS)?h("firebrand_condi"):t.weapons.includes("Greatsword")?h("firebrand_condi_gs"):h("firebrand_condi_quick");if(n==="Willbender")return y(e,l.PURGING_FLAMES)?t.weapons.includes("Greatsword")?h("willbender_condi_gs"):le(e,"Flowing Resolve")?h("willbender_condi_alac_sword"):h("willbender_condi_sword"):h("willbender_power_focus");if(n==="Herald")return t.weapons.includes("Sword")?y(e,l.FACET_OF_LIGHT)?h("herald_boon"):h("herald_power"):h("herald_condi");if(n==="Renegade"){if(t.weapons.includes("Sword"))return h("renegade_alac");let r=e.buffs.hasOwnProperty(l.BATTLE_SCARS);return e.buffs.hasOwnProperty(l.LEGENDARY_ASSASSIN_STANCE)?h("renegade_shiro"):h(r?"renegade_deva_kalla":"renegade_kalla")}return n==="Vindicator"?t.weapons.includes("Sword")?h("vindicator_power_sword"):h("vindicator_power_gs"):n==="Berserker"?t.weapons.includes("Longbow")?y(e,l.SUNDERING_LEAP)?h("berserker_condi"):h("berserker_condi_banners"):y(e,l.THROW_BOLAS)?h("berserker_power"):h("berserker_power_banners"):n==="Spellbreaker"?h("spellbreaker_banners"):n==="Bladesworn"?le(e,"Signet of Fury")?h("bladesworn_power"):h("bladesworn_banners"):Promise.resolve({targetDamage10S:[],casts:[]})}var Ye={[l.PRIMORDIAL_STANCE_EFFECT]:!0},he={5663:"4",43995:"F2"},Se={"Haunt Shot":"1","Grasping Shadows":"2","Dawn's Repose":"3","Eternal Night":"4","Mind Shock":"5"};function Je(e){let t=N.get(e.id);if(!(!t||!t.icon))return t.icon}function Ve(e,t){let n=N.get(e.id);if(n&&n.slot){let r="",s=n.slot.match(/(Weapon|Downed)_(\d)/);if(s&&s.length>0)r=s[2],n.prev_chain&&!n.next_chain&&(r+="f");else if(n.slot==="Elite")r="E";else if(n.slot==="Utility")r="U";else if(n.slot==="Heal")r="H";else if(n.slot==="Toolbelt")r="T";else{let a=n.slot.match(/Profession_(\d)/);a&&a.length>0&&(r="F"+a[1])}return r}else if(t[e.id]){let r=t[e.id];if(r==="Dodge")return"D";if(r.startsWith("Chapter")){let s=r.match(/Chapter (\d)/);if(s&&s.length>0)return"C"+s[1]}else{if(r.startsWith("Epilogue"))return"C5";if(Se.hasOwnProperty(r))return Se[r]}}if(he.hasOwnProperty(e.id))return he[e.id]}function je(e,t,n,r,s,a,o="icon"){let{railHeight:d,railPad:c,timeToX:i}=s;for(let u of n){if(Ye[u.id])continue;let f=document.createElementNS("http://www.w3.org/2000/svg","g"),S=document.createElementNS("http://www.w3.org/2000/svg","title"),_=t.skills[u.id]||u.id,E=`${((u.start-t.start)/1e3).toFixed(2)}s`,g=`${((u.end-u.start)/1e3).toFixed(2)}s`;_+=` (${E}, ${g})`,S.textContent=_;let p=document.createElementNS("http://www.w3.org/2000/svg","rect");p.classList.add("cast"),u.fired||f.classList.add("cancel"),a&&p.classList.add(a);let w=Je(u),R=null;o==="icon"&&(w?(R=document.createElementNS("http://www.w3.org/2000/svg","image"),R.setAttribute("x",i(u.start)),R.setAttribute("y",(d+c)*r+1),R.setAttribute("width",d-2),R.setAttribute("height",d-2),R.classList.add("icon"),R.setAttribute("href",w)):console.warn("No label for skill",u.id,t.skills[u.id]));let v=Ve(u,t.skills),I=null;(o==="name"||!R)&&(v?(I=document.createElementNS("http://www.w3.org/2000/svg","text"),I.setAttribute("x",i(u.start)),I.setAttribute("y",(d+c)*r+d/2),I.classList.add("name"),I.textContent=v):console.warn("No label for skill",u.id,t.skills[u.id])),p.setAttribute("x",i(u.start)),p.setAttribute("y",(d+c)*r);let D=i(u.end)-i(u.start);D>6?p.setAttribute("width",D):(p.setAttribute("width",2),p.classList.add("cast-instant")),p.setAttribute("height",d),f.appendChild(S),f.appendChild(p),R&&f.appendChild(R),I&&f.appendChild(I),e.appendChild(f)}}var z=je;var K={"Do Nothing Transformation Buff":!0,"Conjure Fire Attributes":!0,"Conjure Fiery Greatsword":!0,"Number of Boons":!0,"Ride the Lightning":!0,"Signet of Restoration":!0,"Elemental Refreshment":!0,"The Light of Deldrimor":!0,"Hylek Language Effect":!0,"Incoming!":!0,"Jump Mushroom Knowledge":!0,"Mushroom Tracking Knowledge":!0,"Nuhoch Alchemy":!0,"Radiant Attunement":!0,"Speed Mushroom Knowledge":!0,"Solar Beam":!0,"Stealth Gliding":!0,"Xera's Fury":!0},O={"Fire/Fire":0,"Earth/Fire":1,"Earth/Earth":2,"Fire/Earth":3,"Fire/Water":4,"Water/Fire":5,"Water/Earth":6,"Air/Water":7,"Air/Fire":8,"Air/Air":9,"Fire/Air":10,"Primordial Stance":11,"Elements of Rage":12,"Signet of Fire":13,"Glyph of Elemental Power (Fire)":14,"Magnetic Wave":15,"Weaver's Prowess":16,"Persistent Flames":17,"Fire Aura":18,"Air Attunement":0,"Earth Attunement":1,"Fire Attunement":2,"Water Attunement":3,"Transcendent Tempest":4,"Crescent Wind":5,"Rocky Loop":6,"Flame Wheel":7,"Icy Coil":8,"Relentless Fire":9,"Elemental Empowerment":10,"Empowering Auras":11,"Fencer's Finess":0,"Time Anchored":1,"Signet of the Ether":2,"Mirage Cloak":0,"Compounding Power":1,"Chaos Armor":3,"Deadly Blades":4,"Virtuoso Blade":5,"Signet of Illusions":6,"Reaper's Shroud":0,"Plague Sending":1,"Soul Barbs":2,"Harbinger Shroud":0,Blight:3,"Locust Swarm":4,"Assassin's Signet (Passive)":0,"Assassin's Signet (Active)":1,"Bounding Dodger":2,Revealed:3,"Lead Attacks":4,"Lotus Training":5,"Skale Venom":6,"Spider Venom":7,"Shadow Shroud":0,Kneeling:8,"Deadeye's Gaze":9,"One Wolf Pack":0,"Sharpening Stone":1,"Sic 'Em!":2,"Twice as Vicious":3,Unleashed:2,"Pet Unleashed":3,"Photon Forge":0,Afterburner:1,"Legendary Demon Stance":0,"Legendary Assassin Stance":1,"Legendary Renegade Stance":2,"Legendary Dragon Stance":3,"Legendary Alliance Stance":4,"Legendary Dwarf Stance":5,"Embrace the Darkness":6,"Impossible Odds":7,"Razorclaw's Rage":8,"Improved Kalla's Fervor":9,"Facet of Nature":15,"Facet of Light":16,"Facet of Elements":17,"Facet of Darkness":18,"Facet of Strength":19,"Burst of Strength":20,"Facet of Chaos":21,"Expose Defenses":22,"Forerunner of Death":23,"Zealot's Flame":0,"Renewed Focus":1,"Ashes of the Just":2,"Symbolic Avenger":0,"Shield of Wrath":1,"Spear of Justice":2,Justice:3,"Lethal Tempo":8,"Rushing Justice":9,"Inspiring Virtue":4,"Virtue of Courage":5,"Virtue of Justice":6,"Virtue of Resolve":7};function qe(e){let t=e.buffs;if(!t.hasOwnProperty(l.SPEAR_OF_JUSTICE)){console.log("no spear",e);return}let n=t[l.SPEAR_OF_JUSTICE],r=[];for(let s of n){if(!s.hasOwnProperty("Remove"))continue;let a=s.Remove;if(a===0)continue;let o=6e3*1.33;r.push({Apply:a}),r.push({Remove:a+o})}t[l.JUSTICE]=r,e.skills[l.JUSTICE]="Justice",console.log("did the thing",e)}function pe(e,t,n,r){let s=document.createElementNS("http://www.w3.org/2000/svg","g"),a=document.createElementNS("http://www.w3.org/2000/svg","title"),o=document.createElementNS("http://www.w3.org/2000/svg","rect");return o.setAttribute("x",e),o.setAttribute("y",t),o.setAttribute("height",n),o.classList.add("buff"),r?o.classList.add("buff-outline"):s.appendChild(a),s.appendChild(o),s}function me(e,t,n){let r=e.querySelector("rect");r.setAttribute("width",t(n)-r.getAttribute("x"));let s=e.querySelector("title");if(!s)return;let a=parseFloat(e.dataset.start),o=(parseFloat(e.dataset.start)/1e3).toFixed(2),d=((n-a)/1e3).toFixed(2);s.textContent=`${o}s, ${d}s`}function ze(e,t,n,r,s,a,o,d){let{railHeight:c,railPad:i,timeToX:u}=a;qe(n),r.profession==="Weaver"&&Object.assign(K,{"Fire Attunement":!0,"Water Attunement":!0,"Air Attunement":!0,"Earth Attunement":!0}),r.profession==="Scrapper"&&Object.assign(O,{Stability:0});for(let E in n.buffs)n.skills[E]||(console.warn("Missing skill name",E),n.skills[E]=`${E}`);let f=n.buffs;if(!o){f={};for(let E in n.buffs){let g=n.skills[E];K.hasOwnProperty(g)||O.hasOwnProperty(g)&&(f[E]=n.buffs[E])}}let S=Object.keys(f).sort((E,g)=>{let p=n.skills[E],w=n.skills[g];return O.hasOwnProperty(p)?O.hasOwnProperty(w)?O[p]-O[w]:-1:O.hasOwnProperty(w)?1:p.localeCompare(w)}),_=s;for(let E of S){if(!/^[A-Z]/.test(n.skills[E])||n.skills[E].startsWith("Guild")||K[n.skills[E]])continue;let g=[];for(let p of f[E]){if(p.Apply){let w=pe(u(p.Apply),(c+i)*_,c,d);w.dataset.start=p.Apply,g.push(w)}if(p.Remove){let w=g.pop();w||(w=pe(u(n.start),(c+i)*_,c,d),w.dataset.start=n.start),me(w,u,p.Remove),e.appendChild(w)}}for(let p of g.reverse())me(p,u,n.end),e.appendChild(p);if(!d){let p=document.createElementNS("http://www.w3.org/2000/svg","text");p.textContent=n.skills[E],p.setAttribute("x",0),p.setAttribute("y",_*(c+i)+c/2),p.classList.add("name"),t.appendChild(p)}_+=1}return _-s}var X=ze;function Ee(e){let t=new Array(e.length),n=0;for(let r=0;r<e.length;r++){let s=0;r>=10&&(s=e[r-10]);let o=(e[r]-s)/10;t[r]=o,n=Math.max(o,n)}return{dps10s:t,max:n}}function ge(e,t,n){let{railHeight:r,railPad:s}=t,a=(r+s)*2+s;if(n)return function(i){return a-i/e*a+s};let o=e*1.5,d=Math.log(o-e),c=Math.log(o);return function(i){let u=Math.log(o-i);return(d-u)/(d-c)*a+s}}function _e(e,t,n,r,s){let{timeToX:a}=r,o="",d=ge(n,r,s);for(let i=0;i<t.length;i++){let u=a(i*1e3+e.start),f=d(t[i]);i===0?o+="M":o+="L",o+=u+" "+f+" "}let c=document.createElementNS("http://www.w3.org/2000/svg","path");return c.setAttribute("d",o),c.classList.add("dps-path"),c}var Z=class{constructor(t,n,r,s,a){this.dps10s=n,this.benchDps10s=r,this.timeToX=a.timeToX,this.toY=ge(s,a),this.elt=document.createElementNS("http://www.w3.org/2000/svg","g"),this.elt.classList.add("tooltip"),this.elt.classList.add("tooltip-hidden"),this.diffLine=document.createElementNS("http://www.w3.org/2000/svg","path"),this.diffLine.classList.add("tooltip-path"),this.explanation=document.createElementNS("http://www.w3.org/2000/svg","text"),this.explanation.classList.add("tooltip-explanation"),this.elt.appendChild(this.diffLine),this.elt.appendChild(this.explanation),t.appendChild(this.elt)}show(t,n){if(n<0)return;let r=this.timeToX(t);this.elt.setAttribute("transform",`translate(${r} 0)`),this.diffLine.setAttribute("d","");let s="",a=0;if(n<this.dps10s.length){let o=this.dps10s[n],d=this.toY(o);if(a=d,n<this.benchDps10s.length){let c=this.benchDps10s[n],i=this.toY(c);a=Math.min(a,(d+i)/2);let u=`M0 ${d} L0 ${i}`;this.diffLine.setAttribute("d",u);let f=o-c;s=`${f>0?"Ahead":"Behind"} ${Math.abs(Math.round(f))} at ${n}s (${Math.round(o)} vs ${Math.round(c)})`}else s=`${Math.round(o)}`}this.explanation.textContent=s,this.explanation.setAttribute("x",2),this.explanation.setAttribute("y",a),this.elt.classList.remove("tooltip-hidden")}hide(){this.elt.classList.add("tooltip-hidden")}};function Ke(e,t,n,r,s){let{railHeight:a,railPad:o,xToTime:d}=r,{dps10s:c,max:i}=Ee(t.targetDamage1S),{dps10s:u,max:f}=Ee(n.targetDamage1S),S=Math.max(i,f),_=_e(t,c,S,r,s),E=_e(t,u,S,r,s);E.classList.add("dps-path-benchmark"),e.appendChild(E),e.appendChild(_);let g=(a+o)*2+o,p=new Z(e,c,u,S,r),w=e.parentNode,R;function v(){p.hide()}function I(D){R||(R=w.getBoundingClientRect());let G=D.clientX+w.scrollLeft-R.left,x=d(G),P=Math.round((x-t.start)/1e3);p.show(P*1e3+t.start,P)}e.addEventListener("mousemove",I),e.addEventListener("mouseleave",v)}var we=Ke;var Ae=["ArrowUp","ArrowUp","ArrowDown","ArrowDown","ArrowLeft","ArrowRight","ArrowLeft","ArrowRight","b","a","Enter"],M={notAGoodPlayer:["you are $bad","you make me sick","you should have slash gee geed before you logged in","you should uninstall","uninstall","unplug your computer","you are too heavy for north america, go to europe","you must be from north america","is that you jil","go back to ERPing","I digital vomited in my digital mouth","go play $mmo","think about all the people you have let down with your $bad gameplay","if you want to be rewarded for being so $bad just play $mmo","blocked and reported","why not try some world bosses instead","gwen called, she wants you to uninstall","you made taimi cry","you make gorrik wish he could have joined blish","palawa joko came back but you are so $bad it killed him again","I would rather be in the realm of torment than evaluating gameplay this $bad","thank you for giving me your account name so I can block you"],wastedTime:["in that time I simulated $bigNumber universes, in all of them you were $bad","it took me zero point zero zero $number $number seconds to realize you will never get good","it takes just two minutes to uninstall","you could have downloaded $mmo in that time","were you $afk"],afraid:["afraid","scared"],bad:["trash","bad","terrible","garbage","subpar","disappointing"],mmo:["wow","ffxiv","eso","runescape","guild wars one"],bigNumber:["$number billion","$number hundred $doubleDigitNumber million $number hundred $doubleDigitNumber thousand $number hundred $doubleDigitNumber"],number:["one","two","three","four","five","six","seven","eight","nine"],doubleDigitNumber:["seventeen","twelve","twenty $number","thirty $number","forty $number","fifty $number","sixty $number","seventy $number","eighty $number","ninety $number"],afk:["afk","walking the dog","on a bio break","busy losing a raid tournament because you messed up reflect"],lostCast:["you may hate $spell but I hate your inability to play more","you do realize $spell does damage","$spell is your friend, unlike me","poor thing, in your hands $spell is just as nonexistent as zojja"]},Xe=JSON.stringify(M);function Ze(e){for(;e.includes("$");){let t=/\$(\w+)/.exec(e);if(!t)return e;let n=M[t[1]];if(!n||n.length===0)return console.warn("Unable to substitute",t[1]),e;let r=Math.floor(Math.random()*n.length),s=n[r];e=e.replace(t[0],s)}return e}function Qe(){let e=document.querySelectorAll(".report-card-item");if(e.length===0)return"too $afraid to upload a log? $notAGoodPlayer";let t="";for(let n of e){if(n.querySelector(".grade").textContent==="S")continue;let s=`you ${n.querySelector(".explanation").textContent.toLowerCase()}.`;s=s.replace("/"," out of an ideal ");let a="notAGoodPlayer";Math.random()>.3&&(s.includes("cast")?a="lostCast":s.includes("seconds")&&(a="wastedTime"));let o=M[a];n.dataset.spell?M.spell=[n.dataset.spell]:M.spell=["that spell","that ability","that skill","that spell","that ability","that skill","pressing keys"];let d=Math.floor(Math.random()*o.length),c=Ze(o[d]);M[a].splice(d,1),M[a].length===0&&(M[a]=JSON.parse(Xe)[a]),t+=`${s} ${c}. `}return t===""?"maybe you aren't completely $bad. just kidding, $notAGoodPlayer":t}function et(e){let t=window.speechSynthesis,n=new SpeechSynthesisUtterance(e);for(let r of t.getVoices())r.name==="Daniel"&&(n.voice=r);n.rate=1.2,t.speak(n)}function tt(){let e=Qe();console.log("doing the thing",e),et(e)}var $=0,Te={attach:function(){document.body.addEventListener("keydown",function(e){let t=Ae[$];if(e.key!==t){$=0;return}$+=1,$>=Ae.length&&(tt(),$=0)})}};var ee=document.querySelector(".setup-container");nt();async function nt(){let e=document.querySelector(".dpsreport-text"),t=document.querySelector(".dpsreport-submit");function n(){let c=e.value.trim();if(!/^https:\/\/dps\.report\/[^/]+$/.test(c)){alert("Paste in format https://dps.report/Sosx-20180802-193036_cairn");return}let i=new URL(c);t.value="Fetching",t.removeEventListener("click",n),t.removeEventListener("keypress",r),rt(i.pathname.substr(1))}function r(c){c.key==="Enter"&&n()}t.addEventListener("click",n),e.addEventListener("keypress",r);let s=document.getElementById("log-input");s.addEventListener("change",function(){let c=document.querySelector("#log-input + label");c.textContent="Parsing";let i=s.files[0];setTimeout(function(){st(i)},100)}),ee.classList.remove("hidden");let a=document.querySelector(".gameplay-video-container"),o=document.querySelector(".gameplay-video"),d=document.getElementById("video-input");d.addEventListener("change",function(){let c=document.querySelector("#video-input + label");c.textContent="Uploading";let i=d.files[0];setTimeout(function(){let u=new FileReader;u.onload=function(f){console.log("woot");let S=document.createElement("source");S.src=f.target.result,S.type=i.type,o.appendChild(S),a.classList.remove("no-video")},u.onprogress=function(f){if(f.lengthComputable){let S=Math.floor(100*f.loaded/f.total)+"%";c.textContent="Uploading "+S}},u.readAsDataURL(i)},100)})}function st(e){let t=new FileReader;t.onload=function(n){try{let r=n.target.result,s=Q.default.parseJson(JSON.parse(r));ee.classList.add("hidden"),be(s)}catch{alert("Failed to parse log file, should be JSON blob")}},t.readAsText(e)}function rt(e){Q.default.getJson(e).then(function(t){!t||(ee.classList.add("hidden"),be(t))}).catch(t=>{alert("failed to fetch that log, typo maybe?")})}function be(e){console.log("log",e);let t=new U(e);t.listener=function(n){at(e,n)},t.render()}async function at(e,t){console.log(t,e),e.casts=e.casts[t.id],e.buffs=e.buffs[t.id],e.targetDamage1S=e.targetDamage1S[t.id],e.casts.sort(function(A,k){return A.start-k.start});let n={};for(let A of e.casts)n[A.id]=!0;for(let A in e.skills)!/^[A-Z]/.test(e.skills[A])||(n[A]=!0);let r=await fe(e,t);for(let A of r.casts)n[A.id]=!0;await N.load(n),document.getElementById("benchmark-name").textContent=r.name,r.casts.sort(function(A,k){return A.start-k.start}),document.querySelector(".container").classList.remove("hidden");let s=(e.end-e.start)/20,a=20,o=4,d=document.querySelector(".timeline"),c=document.querySelector(".gameplay-video"),i=document.createElement("div");i.classList.add("board-container"),i.classList.add("show-benchmark");let u=document.createElementNS("http://www.w3.org/2000/svg","svg");u.style.width=s+"px",u.classList.add("board"),i.appendChild(u);let f=document.createElementNS("http://www.w3.org/2000/svg","svg");f.classList.add("legend"),f.classList.add("show-benchmark");let S=document.createElementNS("http://www.w3.org/2000/svg","rect");S.setAttribute("x",0),S.setAttribute("y",0),S.setAttribute("width",2),S.classList.add("needle"),u.appendChild(S),d.appendChild(f),d.appendChild(i);function _(A){return s*(A-e.start)/(e.end-e.start)}function E(A){return A/s*(e.end-e.start)+e.start}let g={[l.ATTUNEMENT_FIRE_FIRE]:"Fire/Fire",[l.ATTUNEMENT_FIRE_AIR]:"Fire/Air",[l.ATTUNEMENT_FIRE_WATER]:"Fire/Water",[l.ATTUNEMENT_FIRE_EARTH]:"Fire/Earth",[l.ATTUNEMENT_AIR_AIR]:"Air/Air",[l.ATTUNEMENT_AIR_WATER]:"Air/Water",[l.ATTUNEMENT_AIR_FIRE]:"Air/Fire",[l.ATTUNEMENT_WATER_FIRE]:"Water/Fire",[l.ATTUNEMENT_WATER_EARTH]:"Water/Earth",[l.ATTUNEMENT_EARTH_EARTH]:"Earth/Earth",[l.ATTUNEMENT_EARTH_AIR]:"Earth/Air",[l.ATTUNEMENT_EARTH_FIRE]:"Earth/Fire"};for(let A in g)e.skills[A]=g[A],r.skills[A]=g[A];for(let A of r.casts)A.start+=e.start,A.end+=e.start;let p={railHeight:a,railPad:o,width:s,timeToX:_,xToTime:E},w={showBenchmark:!0,showDps:!0,showBoringBuffs:!1,videoOffset:1.8,showIcons:!1},R=document.getElementById("show-benchmark");R.checked=w.showBenchmark;let v=document.getElementById("show-dps");v.checked=w.showDps;let I=document.getElementById("show-boring-buffs");I.checked=w.showBoringBuffs;let D=document.getElementById("show-icons");D.checked=w.showIcons;function G(A){return function(k){console.log("onchange",A,k,k.target),w[A]=k.target.checked,Re(e,r,t,p,w)}}R.addEventListener("change",G("showBenchmark")),v.addEventListener("change",G("showDps")),I.addEventListener("change",G("showBoringBuffs")),D.addEventListener("change",G("showIcons")),Re(e,r,t,p,w);let x=i.getBoundingClientRect();function P(A,k){let W=_(A);S.setAttribute("x",W),(!k||W<i.scrollLeft||W>i.scrollLeft+x.width)&&(i.scrollLeft=W-x.width/2),k&&(c.currentTime=(A-e.start)/1e3+w.videoOffset)}u.addEventListener("click",function(A){let k=A.clientX+i.scrollLeft-x.left,W=E(k);P(W,!0)}),document.body.addEventListener("click",function(A){if(A.target.classList.contains("time-link")){A.preventDefault();let k=parseFloat(A.target.dataset.start);k&&P(k,!0)}}),c.addEventListener("timeupdate",function(){P((c.currentTime-w.videoOffset)*1e3+e.start)}),j(e,t,r),Te.attach()}function it(e,t){let n={};for(let r in e.buffs)t.buffs.hasOwnProperty(r)?n[r]=t.buffs[r]:(t.skills[r]=t.skills[r]||e.skills[r],n[r]=[]);t.buffs=n}function Re(e,t,n,r,s){let{railHeight:a,railPad:o}=r,d=document.querySelector(".board"),c=document.querySelector(".legend"),i=document.querySelector(".needle");d.innerHTML="",c.innerHTML="";let u=0;if(s.showDps){we(d,e,t,r);let _=document.createElementNS("http://www.w3.org/2000/svg","text");_.textContent="Damage per 10s",_.setAttribute("x",0),_.setAttribute("y",a/2),_.classList.add("name"),c.appendChild(_),u+=3}if(s.showBenchmark){z(d,e,t.casts,u,r,"benchmark",s.showIcons?"icon":"name");let _=document.createElementNS("http://www.w3.org/2000/svg","text");_.textContent="Benchmark",_.setAttribute("x",0),_.setAttribute("y",u*(a+o)+a/2),_.classList.add("name"),c.appendChild(_),u+=1,it(e,t),X(d,c,t,n,u+1,r,s.showBoringBuffs,!0)}z(d,e,e.casts,u,r,null,s.showIcons?"icon":"name");let S=X(d,c,e,n,u+1,r,s.showBoringBuffs,!1)+1+u;d.style.height=S*(a+o)-o+"px",c.style.height=S*(a+o)-o+"px",i.setAttribute("height",S*(a+o)-o),d.appendChild(i)}})();
//# sourceMappingURL=moxie.js.map
